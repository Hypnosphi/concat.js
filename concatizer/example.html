<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>

<!--<script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>-->
<script src="core.js"></script>

<script type="concat.js/template">

    page title data
        TEST (title)
            h1#identifier.some-class[aaa=bbb]%b-block1{mod=val}
                (title)
        p.ccc
            CHOOSE
                WHEN (data.isUL)
                    CALL ul_list (data.list)
                        h3
                            "This is <UL>"
                WHEN (data.isOL)
                    CALL ol_list (data.list) (1 + 3)
                OTHERWISE
                    em
                        "Nothing"

    ul_list items
        div[data-list=999]
            PAYLOAD
        ul
            CALL list (items)

    ol_list items arg1
        h3
            "arg1 + 1 === "
            (arg1 + 1)
        ol
            CALL list (items)

    list items
        EACH (items)
            li.item
                @num CURRENT
                "item: "
                strong
                    CURRENT
                    "!"

    sep
        section.horizontal-separator
            "sep-sep-sep"

</script>

<script src="../concat.js"></script>
<script src="browser.js"></script>

<script>

    // Extending concat.js with .callTemplate() method that calls compiled
    // templates.
    $C.define('callTemplate', function(item, index, arr, args) {
        var name = args[0];
        args = Array.prototype.slice.call(args, 0);
        args[0] = {parent: this};
        $C.tpl[name].apply(this, args);
    });

    // Now we can simply call templates
    $C(document.body)
        .div({style: {'font-size': '150%'}})
            .callTemplate('page', 'This is page', {})
            .p()
                .text('So, we can call compiled templates')
                .elem('hr')
            .end(2)
            .callTemplate('page', null, {list: [11, 22, 33], isUL: true})
            .callTemplate('sep')
            .callTemplate('page', null, {list: ['aa', 'bb'], isOL: true})
    .end(2);

    /*
    // If we use jQuery, we can create a plugin like this.
    $.fn.$C = function(name) {
        var args = Array.prototype.slice.call(arguments, 0);

        return this.each(function() {
            args[0] = {parent: this};
            $C.tpl[name].apply(this, args);
        });
    };
    // And use it.
    $('body')
        .$C('page', 'This is page', {})
        .$C('sep')
        .$C('page', null, {list: [11, 22, 33], isUL: true})
        .$C('sep')
        .$C('page', null, {list: ['aa', 'bb'], isOL: true});
    */
</script>

</body>
</html>
